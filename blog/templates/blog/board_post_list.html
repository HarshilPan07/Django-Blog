{% extends 'blog/base.html' %}

{% block header %}    
    <div class='row py-3 border-bottom'>
        <div class='mr-auto'>
            <h4>Posts in {{ board }}</h4>
        </div>
        <div>
            <a href="{% url 'create-post' %}" role='button' class='btn btn-outline-primary'>Create Post</a>
            {% if board in user.subs.all %}
                <a href="{% url 'unsubscribe' board.id %}" role="button" class="btn btn-primary">Unsubscribe</a>
            {% else %}
                <a href="{% url 'subscribe' board.id %}" role="button" class="btn btn-primary">Subscribe</a>
            {% endif %}
        </div>
    </div>
{% endblock header %}

{% block content %}
    {% if board.post_set.all %}
        <div class='list-group py-3'>
            {% for post in board.post_set.all %}
                <div class='d-flex bd-highlight'>
                    <div class='px-2 flex-shrink-1 bd-highlight'>
                        <div class='d-flex justify-content-center'>
                            <a href="{% url 'like-post' post.id %}">
                                <svg width="2em" height="2em" viewBox="0 0 16 16" class="bi bi-arrow-up-short" fill="#F73009" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" d="M8 12a.5.5 0 0 0 .5-.5V5.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 5.707V11.5a.5.5 0 0 0 .5.5z"/>
                                </svg>
                            </a>
                        </div>
                        <div class='d-flex justify-content-center'>
                            {% if post in user.post_likes.all %}
                                <strong style="color: #F73009;">{{ post.get_rating }}</strong>
                            {% elif post in user.post_dislikes.all %}
                                <strong style="color: #8283F6;">{{ post.get_rating }}</strong>    
                            {% else %}
                                <strong>{{ post.get_rating }}</strong>
                            {% endif %}
                        </div>
                        <div class='d-flex justify-content-center'>
                            <a href="{% url 'dislike-post' post.id %}"> 
                                <svg width="2em" height="2em" viewBox="0 0 16 16" class="bi bi-arrow-down-short" fill="#8283F6" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" d="M8 4a.5.5 0 0 1 .5.5v5.793l2.146-2.147a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L7.5 10.293V4.5A.5.5 0 0 1 8 4z"/>
                                </svg>
                            </a> 
                        </div>
                    </div>
                    <div class='px-2 py-1 w-100 bd-highlight'>
                        <a href="{% url 'post' post.id %}" class='list-group-item list-group-item-action'>
                            <div class='row'>
                                <div class='col'>
                                    <h5>{{ post.title }}</h5>
                                </div>
                            </div>
                            <div class='row'>
                                <small class='col align-self-start'>posted {{ post.date_posted }} by {{ post.author }}</small>
                            </div>
                            <div class='row'>
                                <small class='col'>Comments: {{ post.comment_set.count }}</small>
                            </div>
                        </a>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <div class='jumbotron m-3'>
            <h3 class='display-4'>Looks like there aren't any posts here!</h3>
            <div class='border-top pt-3'>
                <small class='text-muted'>Click "Create Post" above to add a new post.</small>
            </div>
        </div>
    {% endif %}
    
{% endblock content %}